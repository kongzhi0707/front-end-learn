
### React组件目录结构设计原则

#### 一：组件的基本原则

#### 1.1）单一职责原则

组件库开发中，我们组件原则上只专注一件事情，并且把这件事做好。单一职责的优点是最大可能性的复用组件。

一个复杂的组件，我们可以根据功能点进行拆分，我们可以将每个功能点封装成一个组件。当然也不是组件的颗粒度越小越好，只要将一个组件内的功能和逻辑控制在一个可控的范围内即可。并且想好每个功能组件将来是否还可以进行复用。

举个列子：一个自动完成组件(AutoComplete)，它其实有Input组件和Select组件组合而成的。因此我们可以复用该2个组件。因此 Input 组件 和 Select组件的颗粒度就是合适的。因为他们很容易被复用。

再比如：一个微章组件(Badge)，它的右上角会有红点提示，可能是数字也可能是icon，它的职责可能也单一。按道理也可以把它设计成一个组件，但是正常情况下，我们不会把它设置成一个独立的组件，因为该组件在其他场景中无法复用到。其他场景中不会用到小红点这个组件了。因此我们可能会把它设置到 Badge内部组件了。

因此，所谓的单一职责组件是要建立在可复用的基础之上，对于不可复用的单一职责组件我们仅仅把它作为独立组件的内部组件即可。

职责单一的优点是：

1）降低组件的复杂度，职责单一组件代码量少，容易被理解，可读性高。
2）降低对其他组件的耦合，当变更到来时可以降低对其他功能的影响，不至于牵一发动而全身。
3）提高可复用性，功能越单一可复用性越高。

#### 1.2）通用性考量

我们组件设计需要有通用性方案，通用组件是和业务解藕但是又服务于业务开发的。那么如何保证组件的通用性呢？

比如我们设计一个Select组件，一般情况下我们会设计成如下这个样子：

<img src="https://kongzhi0707.github.io/front-end-learn/frontEndComponent/images/0.png" /><br />

如上是我们很常见的结构，但是有时候Select组件还有可能是如下这个样子：

<img src="https://kongzhi0707.github.io/front-end-learn/frontEndComponent/images/1.png" /><br />

因此我们设计组件的时候不仅仅要考虑上面的通用性各种情况下结构外，我们还需要给组件预留类似 itemRender 的自定义渲染函数，对于一些特殊的结构可以让用户自己去渲染相对应的DOM结构来满足对应的需求。也就是需要把对应的钩子回调初始化函数暴露给开发者，让他们自己去负责渲染操作。当然提供回调钩子还有很多情况，比如选择下拉框的某一项后，我们也可以给开发者提供回调，让他们自己做自己的事情。

#### 1.3）可配置性

一个组件，需要明确它的输入和输出分别是什么。

组件除了上面要展示默认的内容外，我们还需要做一些动态的适配。比如：一个组件有一段文本，一个图片和一个按钮，那么字体的颜色，图片的规则，按钮的位置，按钮的点击事件处理逻辑等，都可以做成可配置的。

要做成可配置性，我们需要通过属性向组件传递配置的值，而在组件初始化声明的周期内，通过读取属性的配置值来渲染出对应的数据结构值。当然我们还需要有一些方法，通过调用组件暴露出来的函数，向函数传递有效的值，修改全局css样式，或向组件传递特定的事件，并且在组件内监听该事件来执行函数等操作。

在做可配置性时，为了让组件更加的健壮，保证组件接收的是有效的属性，函数接收到的是有效的参数，我们需要做一些校验。

#### 二）组件的分类

#### 2.1）容器组件和展示组件的分离

两者的区别是：

|            |  容器组件            |     展示组件       |     
|  关注点     |   业务               |     UI           |
|  数据源     |   状态管理器/后端      |     props        |
|  组件形式   |   高阶组件            |     普通组件       |

1）展示组件 是一个只关注展示的元件，为了可以在多个地方被复用，它不应该耦合 '业务/功能'。

下面是一个典型的应用目录结构，可以看到 展示组件和业务/功能是可能有不同的耦合程度，和业务的耦合程度越低，通用性/可复用性越好。

｜--- src 
｜ |--- components         # 通用的组件库，可以被多个容器/页面组件共享
｜ |--- container
｜ | |--- Foo
｜ | | |--- components    # 容器/页面组件特有的组件库，和一个业务/功能深度耦合，以至于不能被其他容器组件共享 
｜ | | |--- index.tsx
｜ | |--- Bar
｜ | | |--- components
｜ | | |--- index.tsx

2）容器组件 主要关注业务处理，容器组件一般以 '高阶组件' 的形式存在。它一般从外部数据源(redux状态管理器或直接请求服务器端)获取数据，然后以组合展示组件来构建完整的视图页面。

#### 容器组件和展示组件的分离 优点是 提高复用性和可维护性

1）可复用性：展示组件可以用于多个不同的数据源（容器组件），容器组件（业务逻辑）也可以被复用于不同的展示组件。
2）展示和容器组件更好的分离，有助于更好的理解应用和UI，两者可以被独立的维护。
3）展示组件变得轻量，更容器被测试。

#### 2.2）分离逻辑和视图

容器组件和展示组件的分离本质上是 逻辑和视图的分离。








