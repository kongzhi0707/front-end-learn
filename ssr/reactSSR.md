
### React服务器端渲染

#### 一：SSR vs CSR

#### 1. 什么是服务器端渲染？

我们先起一个express服务，在目录文件夹下 新建一个nodejs.js 代码如下：

const express = require('express');
const app = express();

app.get('/', (req, res) => {
  res.send(
    `<html>
      <head>
        <title>Hello World</title>
      </head>
      <body>
        <h1>hello world</h1>
      </body>
     </html>`
  )
});

app.listen(3001, () => {
  console.log('listen:3001');
});

然后，运行 node nodejs.js 后，会启动服务器，我们在浏览器中打开 http://localhost:3001 就可以看到页面显示 Hello World，当我们查看网页源码的时候，如下：

如图1

也是能够完全显示，这就是我们说的服务器端渲染，简单的可以理解为 html字符串放在服务器端渲染，然后让浏览器显示出来。

与服务器端渲染相对的就是客户端渲染(Client Side Render), 那么什么是客户端渲染呢？我们一样可以使用 React脚手架简单的创建一个React项目，然后启动起来，然后我们打开网页的源码，可以看到如下：

如图2

body中除了 script 引入js外，还有一个div的id为root的元素，那么我们的页面渲染的内容是通过js来动态加载出来的。

因此服务器端渲染和客户端渲染的区别是：html字符串是由服务器端渲染的就是服务器渲染，否则的话就是客户端渲染。

#### 2. 服务器端渲染的优点？

优点是：

1. 有利于SEO搜索引擎，后端直接返回html字符串，爬虫可以获取到信息。
2. 前端耗时少，首屏幕加载更快，因为页面是服务器端输出的，前端不需要通过ajax去动态加载。
3. 不需要占用客户端资源。因为解析html模版的工作是交给服务器端来完成的，客户端只需要解析标准的html页面即可。这样客户端占用的资源会变少。
4. 后端生成静态文件，即生成缓存片段，这样就可以减少数据库查询时间。

#### 3. 客户端渲染的优点和缺点？

优点是：

1. 前后端分离，前端只专注于前端UI开发，后端专注于API开发。
2. 用户体验更好，比如我们前端页面可以做成SPA页面，体验更接近原生APP。

缺点：

1. 不利于SEO，因为html页面都是通过 js+dom异步动态拼接加载的，当我们使用爬虫获取的时候，由于js异步加载，所以爬取不到内容的。
2. 前端耗时多，响应比较慢，因为html模版页面放在前端是通过DOM去拼接及加载的，需要额外的耗时，没有服务器端渲染快。

#### 4. 何时使用服务器端渲染，何时使用客户端渲染？

对于我们常见的后端系统页面，交互性强，不需要考虑SEO搜索引擎，对首屏加载不需要那么强的话，我们只需要客户端渲染比较好。但是对于一些企业的网站，没有很多复杂的交互性功能，并且需要首屏加载更快，需要很好的SEO搜索引擎的话，那么这个时候就需要服务器端渲染，比如淘宝官网这些一般需要服务器端渲染比较好。

#### 二：React实现服务器端渲染



